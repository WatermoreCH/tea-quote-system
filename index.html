<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŒ¶åŒ¯å…¬å¸ | å°ˆæ¥­èŒ¶åŒ… OEM å®¢è£½åŒ–å ±åƒ¹ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        [x-cloak] { display: none !important; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f4f6f3; scroll-behavior: smooth; }
        .hero-spotlight {
            background: radial-gradient(circle at 20% 30%, rgba(197, 160, 89, 0.2) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(197, 160, 89, 0.15) 0%, transparent 40%),
                        #1A302B;
        }
        .text-glow-gold { text-shadow: 0 0 30px rgba(197, 160, 89, 0.6); }
        .gold-value-block {
            background: linear-gradient(145deg, #D4B475 0%, #C5A059 100%);
            box-shadow: inset 0 1px 1px rgba(255,255,255,0.4), 0 20px 40px -10px rgba(197, 160, 89, 0.4);
        }
        .cta-destructive {
            background: linear-gradient(180deg, #FFD98E 0%, #C5A059 100%);
            box-shadow: 0 15px 35px -5px rgba(197, 160, 89, 0.6), 0 8px 0 #8E713A;
            transition: all 0.15s ease-out;
        }
        .cta-destructive:hover { transform: translateY(-4px); box-shadow: 0 20px 40px -5px rgba(197, 160, 89, 0.7), 0 10px 0 #8E713A; }
        .cta-destructive:active { transform: translateY(4px); box-shadow: 0 0 0 #8E713A; }
        .card-active { border: 4px solid #1A302B !important; background-color: #fffdf5 !important; box-shadow: 0 15px 30px -5px rgba(197, 160, 89, 0.3) !important; color: #1A302B !important; z-index: 20; position: relative; }
        .hover-zoom { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .hover-zoom:hover { transform: scale(1.05); filter: brightness(1.05); }
    </style>
</head>
<body x-data="quoteSystem()" class="text-slate-900 leading-relaxed text-base md:text-lg">

    <header class="hero-spotlight text-white py-16 md:py-32 px-6 text-center relative overflow-hidden">
        <div class="max-w-5xl mx-auto relative z-10 text-center">
            <div class="flex justify-center gap-3 mb-8 opacity-90 flex-wrap text-center">
                <span class="bg-white/10 px-4 py-1.5 rounded-full text-sm font-bold border border-white/20 whitespace-nowrap">ISO 22000 èªè­‰å·¥å» </span>
                <span class="bg-white/10 px-4 py-1.5 rounded-full text-sm font-bold border border-white/20 whitespace-nowrap">HACCP é£Ÿå“å®‰å…¨èªè­‰</span>
                <span class="bg-white/10 px-4 py-1.5 rounded-full text-sm font-bold border border-white/20 whitespace-nowrap">FDA é£Ÿå“è¨­æ–½è¨»å†Š</span>
            </div>
            <h1 class="text-3xl md:text-7xl font-black mb-8 leading-tight tracking-tighter break-words text-center">
                èŒ¶åŒ…å®¢è£½åŒ– <span class="text-[#C5A059] text-glow-gold">æ­£å¼å ±åƒ¹</span> ç³»çµ±
            </h1>
            <p class="text-base md:text-2xl text-slate-300 font-medium max-w-3xl mx-auto leading-relaxed break-words px-4 text-center">
                çœç•¥ç„¡æ•ˆè©¢å•ï¼Œå¾é€™è£¡ç²å–ä¸€ä»½<br class="hidden md:block">
                <span class="text-white border-b-4 border-[#C5A059] pb-1 font-black">å…·å‚™æ¡è³¼æ¨™æº–èˆ‡æ³•å¾‹æ•ˆåŠ›çš„æ­£å¼å ±åƒ¹å–®ã€‚</span>
            </p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto py-12 px-4 md:px-6">
        
        <section class="mb-16">
            <div class="text-center mb-10">
                <h2 class="text-2xl md:text-4xl font-black text-slate-900">æ­¥é©Ÿä¸€ï¼šæ‚¨çš„å“ç‰Œç¶“ç‡Ÿéšæ®µ</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <template x-for="stage in stages" :key="stage.id">
                    <button @click="selectStage(stage)"
                        :class="selectedStageId === stage.id ? 'card-active scale-105' : 'bg-white border border-gray-200 opacity-80 md:opacity-100'"
                        class="p-8 rounded-[2rem] text-left transition-all relative group flex flex-col items-center overflow-hidden shadow-sm text-center">
                        <div x-show="stage.recommended" class="absolute top-0 right-0 bg-[#C5A059] text-[#1A302B] text-xs px-4 py-1.5 rounded-bl-2xl font-black">æ¨è–¦æ–¹æ¡ˆ</div>
                        <div class="text-5xl mb-6" x-text="stage.icon"></div>
                        <h3 class="text-xl md:text-2xl font-black mb-3" x-text="stage.name"></h3>
                        <p class="text-slate-600 text-base md:text-lg leading-relaxed break-words text-center" x-text="stage.desc"></p>
                    </button>
                </template>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-10 items-start">
            <div class="lg:col-span-7 space-y-10">
                <div class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-sm border border-slate-100">
                    <h2 class="text-xl md:text-2xl font-black mb-8 flex items-center">
                        <span class="bg-slate-900 text-white w-8 h-8 rounded-full inline-flex items-center justify-center mr-4 text-sm font-black text-center">02</span>
                        é¸æ“‡å®¢è£½ç­‰ç´š
                    </h2>
                    <div class="grid grid-cols-2 md:grid-cols-5 gap-3 text-center">
                        <template x-for="plan in allPlans" :key="plan.id">
                            <div class="relative">
                                <button @click="selectPlan(plan)"
                                    :class="selectedPlanId === plan.id ? 'card-active shadow-2xl scale-105 border-slate-900' : (plan.id === 'C' ? 'border-[#C5A059] bg-[#FFFDF5]' : getPlanBg(plan.id)) + ' border-transparent'"
                                    class="w-full py-6 px-1 rounded-xl transition-all text-center text-sm md:text-base break-words border-4 flex flex-col items-center justify-center min-h-[130px]">
                                    <div class="text-[10px] md:text-xs opacity-80 font-black mb-1 uppercase">æ–¹æ¡ˆ <span x-text="plan.id"></span></div>
                                    <div class="font-black leading-tight" x-text="plan.name"></div>
                                    <div class="text-[10px] md:text-xs mt-2 opacity-80 font-bold">èµ·è¨‚: <span x-text="plan.moq"></span></div>
                                </button>
                                <template x-if="plan.id === 'C'">
                                    <div class="absolute -bottom-3 left-1/2 -translate-x-1/2 bg-[#C5A059] text-[#1A302B] text-[10px] md:text-xs px-3 py-1 rounded-full font-black shadow-md whitespace-nowrap z-10 text-center">æœ€å—æ­¡è¿ â­</div>
                                </template>
                            </div>
                        </template>
                    </div>
                </div>

                <div class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-sm border border-slate-100">
                    <h2 class="text-xl md:text-2xl font-black mb-2 flex items-center">
                        <span class="bg-slate-900 text-white w-8 h-8 rounded-full inline-flex items-center justify-center mr-4 text-sm font-black text-center">03</span>
                        èŒ¶åŒ…å…§è¢‹æè³ª
                    </h2>
                    <p class="text-slate-400 text-sm md:text-base mb-8 ml-12 font-bold text-center">æ¨™æº–è¦æ ¼ï¼š5.8 Ã— 5.8 å…¬åˆ† (æ‰€æœ‰æ–¹æ¡ˆå›ºå®š)</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 ml-0 md:ml-12">
                        <template x-for="mat in materials" :key="mat.name">
                            <button @click="selectedMaterial = mat"
                                :class="selectedMaterial.name === mat.name ? 'card-active ring-2' : getMatBg(mat.type) + ' border-transparent text-slate-700'"
                                class="p-5 rounded-2xl text-left transition-all border-4 flex flex-col justify-between min-h-[110px]">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="font-black text-base md:text-lg" x-text="mat.name"></span>
                                    <span :class="selectedMaterial.name === mat.name ? 'bg-slate-900 text-white' : 'bg-white/50 text-slate-800'" class="text-xs px-2 py-0.5 rounded font-black uppercase text-center" x-text="mat.type"></span>
                                </div>
                                <div class="text-[#1A302B] font-black text-lg md:text-xl">+ æ¯åŒ… <span x-text="mat.surcharge.toFixed(1)"></span> å…ƒ</div>
                            </button>
                        </template>
                    </div>
                </div>

                <div class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-sm border border-slate-100">
                    <h2 class="text-xl md:text-2xl font-black mb-8 flex items-center">
                        <span class="bg-slate-900 text-white w-8 h-8 rounded-full inline-flex items-center justify-center mr-4 text-sm font-black text-center">04</span>
                        åŒ…è£çµæ§‹èªªæ˜
                    </h2>
                    <div class="ml-0 md:ml-12">
                        <div x-show="!canBox" class="bg-slate-50 border-4 border-dotted border-slate-200 py-12 rounded-3xl text-center px-4">
                            <p class="text-slate-400 font-black text-base md:text-lg text-center">æ­¤æ–¹æ¡ˆæœªé–‹æ”¾ç›’è£å®¢è£½ï¼Œ<br>è«‹å‡ç´šæ–¹æ¡ˆ C / D è§£é–</p>
                        </div>
                        <div x-show="canBox" class="bg-slate-900 text-white p-8 rounded-[2.5rem] flex flex-col md:flex-row gap-8 items-center text-center">
                            <div class="flex-1 space-y-4">
                                <div class="bg-[#C5A059] text-[#1A302B] px-4 py-1.5 rounded-full text-sm font-black inline-block uppercase tracking-widest text-center" x-text="boxName"></div>
                                <ul class="text-sm md:text-lg space-y-2 text-slate-400 font-medium text-center">
                                    <li>â€¢ å°ºå¯¸ï¼š10 Ã— 10 Ã— 11.5 å…¬åˆ†</li>
                                    <li>â€¢ æè³ªï¼šç™½å¡ 45T / éœ§è†œè™•ç†</li>
                                    <li>â€¢ å®¹é‡ï¼šæ¯ç›’ 15 å…¥</li>
                                </ul>
                            </div>
                            <div class="flex flex-col items-center gap-3">
                                <a href="https://www.bpbpack.com.tw/products/3a14-16006" target="_blank" class="block bg-white/10 p-2 rounded-3xl border border-white/20 hover-zoom shadow-2xl group relative overflow-hidden">
                                    <div class="w-32 h-32 md:w-40 md:h-40 bg-white rounded-2xl flex items-center justify-center p-2">
                                        <img src="https://www.bpbpack.com.tw/archive/products/item/3a14-16006/3a14-16006_01.jpg" alt="å¤–ç›’çµæ§‹" class="w-full h-full object-contain">
                                    </div>
                                    <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-2xl text-center">
                                        <span class="text-[10px] font-black text-white px-2 py-1 border border-white rounded text-center">æŸ¥çœ‹è©³ç´°è¦æ ¼</span>
                                    </div>
                                </a>
                                <p class="text-[10px] md:text-xs text-[#C5A059] font-black tracking-widest text-center">ç¬¬ä¸‰æ–¹å°ˆæ¥­åŒ…æä¾›æ‡‰å•†è¦æ ¼é </p>
                            </div>
                        </div>

                        <div class="mt-10 pt-8 border-t border-slate-100">
                            <p class="text-xs font-black text-slate-400 uppercase tracking-[0.2em] mb-4 text-center">è¨­è¨ˆç”¨åˆ€æ¨¡ä¸‹è¼‰ / Templates Download</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <a href="https://drive.google.com/uc?export=download&id=1NJ1KLuRwE_eFzVCnb1qX1tD2uFF6JFKL" target="_blank" class="flex items-center justify-between p-4 bg-slate-50 rounded-2xl border border-slate-200 hover:border-slate-400 transition-all group">
                                    <div class="text-left">
                                        <p class="text-[10px] text-slate-400 font-bold uppercase">èŒ¶åŒ…å¤–è¢‹ç©ºç™½åˆ€æ¨¡</p>
                                        <p class="text-sm font-black text-slate-700">å°ºå¯¸ï¼š105 Ã— 90 mm</p>
                                    </div>
                                    <span class="text-[10px] bg-slate-900 text-white px-3 py-1 rounded-full font-black group-hover:bg-[#C5A059] transition-colors text-center">ç›´æ¥ä¸‹è¼‰ .AI</span>
                                </a>
                                <a href="https://drive.google.com/uc?export=download&id=1w85ERYJze6K_HWoYHO_aovvyEGBRWgXc" target="_blank" class="flex items-center justify-between p-4 bg-slate-50 rounded-2xl border border-slate-200 hover:border-slate-400 transition-all group">
                                    <div class="text-left">
                                        <p class="text-[10px] text-slate-400 font-bold uppercase">ä¸Šæ€ç›’(M) åˆ€æ¨¡æª”</p>
                                        <p class="text-sm font-black text-slate-700">å°æ‡‰ï¼šä¸Šæ€ç›’(M)è¦æ ¼</p>
                                    </div>
                                    <span class="text-[10px] bg-slate-900 text-white px-3 py-1 rounded-full font-black group-hover:bg-[#C5A059] transition-colors text-center">ç›´æ¥ä¸‹è¼‰ .PDF</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-sm border border-slate-100">
                    <h2 class="text-xl md:text-2xl font-black mb-8 flex items-center">
                        <span class="bg-slate-900 text-white w-8 h-8 rounded-full inline-flex items-center justify-center mr-4 text-sm font-black text-center text-center">05</span>
                        è¨­å®šè¨‚è³¼æ•¸é‡
                    </h2>
                    <div class="ml-0 md:ml-12">
                        <div class="grid grid-cols-3 md:grid-cols-5 gap-3 mb-10 text-center">
                            <template x-for="qty in qtyOptions" :key="qty">
                                <button @click="quantity = qty"
                                    x-show="qty >= minMoq"
                                    :class="quantity === qty ? 'bg-slate-900 text-white font-black shadow-2xl' : 'bg-slate-100 text-slate-400 font-bold'"
                                    class="py-4 text-base md:text-lg rounded-xl transition-all shadow-sm text-center"
                                    x-text="qty.toLocaleString()">
                                </button>
                            </template>
                        </div>
                        <div x-show="lowMoqSurcharge > 0" class="bg-amber-50 border-l-8 border-amber-400 p-6 md:p-8 rounded-2xl flex items-start gap-5 shadow-sm text-center">
                            <div class="text-3xl md:text-4xl mt-1 text-center">ğŸ’¡</div>
                            <div class="text-base md:text-lg text-amber-900 leading-relaxed font-bold text-center">
                                ç³»çµ±æç¤ºï¼šç›®å‰è¨‚è³¼é‡æœªé”æ¨™æº–é–‹æ©Ÿé‡ (2,000åŒ…)ï¼Œå ±åƒ¹å·²è‡ªå‹•åŒ…å« <span class="bg-amber-200 px-1 rounded font-black">å°é‡ç”Ÿç”¢èª¿åº¦è²» (+æ¯åŒ… <span x-text="lowMoqSurcharge"></span> å…ƒ)</span>ã€‚
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <aside class="lg:col-span-5 sticky top-8">
                <div class="bg-[#1A302B] rounded-[2.5rem] p-8 md:p-12 text-white shadow-2xl relative overflow-hidden">
                    <div class="absolute -top-10 -right-10 w-40 h-40 bg-[#C5A059] opacity-10 rounded-full blur-3xl text-center"></div>
                    <h3 class="text-xs md:text-sm font-black tracking-[0.3em] text-[#C5A059] mb-10 uppercase text-center">å ±åƒ¹æ˜ç´°ç¸½çµ</h3>
                    
                    <div class="space-y-6 text-base md:text-lg mb-10 font-medium text-center">
                        <div class="flex justify-between border-b border-white/10 pb-4 text-left">
                            <span class="opacity-60 shrink-0">å·²é¸å®¢è£½æ–¹æ¡ˆ</span>
                            <span class="font-black text-right" x-text="'æ–¹æ¡ˆ ' + selectedPlanId + 'ï½œ' + selectedPlan.name"></span>
                        </div>
                        <div class="flex justify-between border-b border-white/10 pb-4 text-left">
                            <span class="opacity-60">å…§è¢‹æè³ªåŠ åƒ¹</span>
                            <span class="text-[#C5A059] font-black text-right" x-text="'+ æ¯åŒ… ' + selectedMaterial.surcharge.toFixed(1) + ' å…ƒ'"></span>
                        </div>
                        <template x-if="canBox">
                            <div class="bg-white/5 p-6 rounded-3xl space-y-3 text-sm md:text-base border border-white/5 text-center">
                                <div class="flex justify-between font-black text-white text-center"><span>ä¸€æ¬¡æ€§æ‰“æ¨£è²» (å«ç¨…)</span><span>525 å…ƒ</span></div>
                                <div class="flex justify-between opacity-60 text-center"><span>ç‰©æµèˆ‡å€‰å„²è²»ç”¨</span><span>300 å…ƒ</span></div>
                            </div>
                        </template>
                    </div>

                    <div class="gold-value-block p-8 md:p-10 rounded-[2.5rem] text-[#1A302B] mb-10 text-center">
                        <div class="flex justify-between items-end mb-8 text-center text-center">
                            <span class="text-sm font-black uppercase tracking-widest opacity-80 text-left">æœ€çµ‚å–®åƒ¹</span>
                            <div class="text-right">
                                <span class="block text-xs font-black mb-1" x-show="quantity >= 10000">âœ“ å·²å¥—ç”¨å¤§å®—è¨‚è³¼æŠ˜æ‰£</span>
                                <span class="text-3xl md:text-6xl font-black tracking-tighter" x-text="'NT$ ' + finalUnitPrice"></span>
                            </div>
                        </div>
                        <div class="pt-8 border-t border-[#1A302B]/20 text-center">
                            <div class="text-sm font-black uppercase tracking-widest opacity-80 mb-2 text-left">å°ˆæ¡ˆé ä¼°ç¸½é‡‘é¡</div>
                            <div class="text-4xl md:text-6xl font-black tracking-tighter text-center">NT$ <span x-text="totalPrice.toLocaleString()"></span></div>
                        </div>
                    </div>

                    <button @click="showForm = true; $nextTick(() => document.getElementById('form-section').scrollIntoView({behavior:'smooth'}))" 
                        class="cta-destructive w-full text-[#1A302B] py-6 md:py-8 rounded-[2.5rem] font-black text-xl md:text-3xl tracking-widest uppercase mb-4 text-center">
                        ç”¢å‡ºæ­£å¼å ±åƒ¹å–®
                    </button>
                    <p class="text-center text-[10px] md:text-xs opacity-40 font-black tracking-widest leading-relaxed text-center">ç”± Teaauction Co., Ltd. å ±åƒ¹ç³»çµ±é©—è­‰</p>
                </div>
            </aside>
        </div>

        <section id="form-section" x-show="showForm" x-transition class="mt-24 max-w-4xl mx-auto">
            <div class="bg-[#1A302B] text-white p-8 md:p-12 rounded-t-[4rem] border-b border-[#C5A059]/30 shadow-2xl text-center">
                <p class="text-lg md:text-2xl font-black leading-relaxed tracking-tighter text-center text-center">
                    æ‚¨ç›®å‰è¨­å®šçš„è¦æ ¼ï¼Œå°‡ä½œç‚ºæ­£å¼å ±åƒ¹èˆ‡ç”Ÿç”¢ä¾æ“šã€‚<br>
                    PDF å ±åƒ¹å–®ç”¢å‡ºå¾Œï¼Œè¦æ ¼å°‡é€²å…¥é–å®šæµç¨‹ã€‚
                </p>
            </div>

            <div class="bg-white p-10 md:p-20 rounded-b-[4rem] shadow-2xl border border-slate-100 text-left">
                <form @submit.prevent="handleSubmit" class="space-y-10">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10 text-left">
                        <div class="space-y-4">
                            <label class="text-base md:text-lg font-black text-slate-800 ml-2">å…¬å¸æŠ¬é ­ / çµ±ä¸€ç·¨è™Ÿ *</label>
                            <input type="text" x-model="formData.company" required class="w-full px-8 py-5 bg-slate-50 border-none rounded-2xl focus:ring-4 focus:ring-[#C5A059]/40 font-bold text-lg" placeholder="è«‹è¼¸å…¥å®Œæ•´å…¬å¸åç¨±">
                        </div>
                        <div class="space-y-4">
                            <label class="text-base md:text-lg font-black text-slate-800 ml-2">è¯çµ¡äººå§“å *</label>
                            <input type="text" x-model="formData.name" required class="w-full px-8 py-5 bg-slate-50 border-none rounded-2xl focus:ring-4 focus:ring-[#C5A059]/40 font-bold text-lg" placeholder="æ‚¨çš„çœŸå¯¦å§“å">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10 text-left">
                        <div class="space-y-4">
                            <label class="text-base md:text-lg font-black text-slate-800 ml-2">æ¥æ”¶å ±åƒ¹ä¹‹é›»å­ä¿¡ç®± *</label>
                            <input type="email" x-model="formData.email" required class="w-full px-8 py-5 bg-slate-50 border-none rounded-2xl focus:ring-4 focus:ring-[#C5A059]/40 font-bold text-lg" placeholder="å ±åƒ¹å–®å°‡å¯„é€è‡³æ­¤">
                        </div>
                        <div class="space-y-4">
                            <label class="text-base md:text-lg font-black text-slate-800 ml-2">è¯çµ¡é›»è©±æˆ– LINE ID *</label>
                            <input type="text" x-model="formData.contact" required class="w-full px-8 py-5 bg-slate-50 border-none rounded-2xl focus:ring-4 focus:ring-[#C5A059]/40 font-bold text-lg" placeholder="æ–¹ä¾¿é¡§å•ç¢ºèªæ‰“æ¨£ç´°ç¯€">
                        </div>
                    </div>
                    
                    <button type="submit" :disabled="loading" class="w-full bg-slate-900 text-white py-8 rounded-[2.5rem] font-black text-2xl md:text-4xl shadow-2xl hover:bg-black transition-all transform active:scale-95 flex justify-center items-center">
                        <span x-show="!loading" class="text-center">ç¢ºèªè¦æ ¼ä¸¦å¯„é€å ±åƒ¹å–®</span>
                        <span x-show="loading" class="flex items-center text-center">
                            <svg class="animate-spin h-10 w-10 mr-6 text-[#C5A059]" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                            æ­£åœ¨å»ºç«‹æ­£å¼å ±åƒ¹ç·¨è™Ÿ...
                        </span>
                    </button>
                </form>
            </div>
        </section>

        <section id="upload-section" class="mt-12 max-w-4xl mx-auto pb-32">
            <div class="bg-white p-8 md:p-12 rounded-[2.5rem] shadow-sm border-4 border-dashed border-[#C5A059]/30 text-left">
                <div class="mb-8">
                    <h2 class="text-xl md:text-2xl font-black mb-2 flex items-center">
                        <span class="bg-[#C5A059] text-[#1A302B] w-8 h-8 rounded-full inline-flex items-center justify-center mr-4 text-sm font-black text-center text-center">06</span>
                        è¨­è¨ˆæª”æ¡ˆå®‰å…¨ä¸Šå‚³
                    </h2>
                    <p class="text-slate-400 font-bold text-sm ml-12 text-left">å¦‚æœæ‚¨å·²æœ‰å ±åƒ¹ç·¨è™Ÿï¼Œè«‹åœ¨æ­¤ä¸Šå‚³è¨­è¨ˆç¨¿ï¼Œé¡§å•å°‡æ–¼ 24H å…§å›è¦†å¯©æ ¸çµæœã€‚</p>
                </div>

                <div x-show="uploadStep === 'email'" class="space-y-6 ml-0 md:ml-12 text-left">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-left">
                        <div class="space-y-2">
                            <label class="text-xs font-black text-slate-400 uppercase tracking-widest">æ­£å¼å ±åƒ¹ç·¨è™Ÿ *</label>
                            <input type="text" x-model="quoteNumber" class="w-full px-6 py-4 bg-slate-50 rounded-xl border-none focus:ring-2 focus:ring-[#C5A059] font-black text-[#1A302B]" placeholder="ä¾‹: QT-2024-05-XXXX">
                        </div>
                        <div class="space-y-2 text-left">
                            <label class="text-xs font-black text-slate-400 uppercase tracking-widest">é©—è­‰é›»å­ä¿¡ç®± *</label>
                            <input type="email" x-model="uploadEmail" class="w-full px-6 py-4 bg-slate-50 rounded-xl border-none focus:ring-2 focus:ring-[#C5A059] font-bold" placeholder="è«‹è¼¸å…¥åŸå ±åƒ¹ Email">
                        </div>
                    </div>
                    <button @click="sendOTP()" :disabled="isVerifying" class="w-full bg-slate-900 text-white py-5 rounded-xl font-black hover:bg-black transition-all flex justify-center text-center">
                        <span x-show="!isVerifying">ç™¼é€æª”æ¡ˆä¸Šå‚³é©—è­‰ç¢¼</span>
                        <span x-show="isVerifying">æ­£åœ¨ç™¼é€è‡³ä¿¡ç®±...</span>
                    </button>
                </div>

                <div x-show="uploadStep === 'otp'" class="space-y-6 ml-0 md:ml-12" x-cloak text-left>
                    <div class="text-center bg-slate-50 p-6 rounded-2xl">
                        <p class="text-slate-600 font-bold mb-4 text-center">é©—è­‰ç¢¼å·²å¯„å‡ºï¼Œè«‹æª¢æŸ¥æ‚¨çš„ä¿¡ç®±</p>
                        <div class="flex gap-4 max-w-sm mx-auto">
                            <input type="text" x-model="otpInput" maxlength="6" class="flex-1 px-6 py-4 bg-white border-2 border-slate-200 rounded-xl text-center tracking-[0.5em] text-2xl font-black focus:border-[#C5A059] outline-none" placeholder="000000">
                            <button @click="verifyOTP()" :disabled="isVerifying" class="bg-[#C5A059] text-[#1A302B] px-8 rounded-xl font-black hover:brightness-110 transition-all text-center">
                                é©—è­‰
                            </button>
                        </div>
                        <button @click="uploadStep = 'email'" class="mt-4 text-xs text-slate-400 font-bold underline text-center">ä¿®æ”¹è³‡è¨Šé‡æ–°ç™¼é€</button>
                    </div>
                </div>

                <div x-show="uploadStep === 'upload'" class="ml-0 md:ml-12 py-4" x-cloak text-center>
                    <label class="cursor-pointer group block">
                        <input type="file" class="hidden" @change="handleFileUpload">
                        <div class="border-4 border-dotted border-slate-200 rounded-[2.5rem] p-16 group-hover:border-[#C5A059] transition-all bg-slate-50 text-center">
                            <div class="text-6xl mb-6">ğŸ“</div>
                            <p class="text-xl font-black text-slate-900">é»æ“Šæˆ–æ‹–æ›³è¨­è¨ˆç¨¿è‡³æ­¤</p>
                            <p class="text-sm text-slate-400 mt-2 font-bold italic">ç¶å®šå–®è™Ÿï¼š<span x-text="quoteNumber" class="text-slate-900 underline"></span></p>
                            <p class="text-xs text-slate-300 mt-4 uppercase">AI, PDF, ZIP / MAX 10MB</p>
                        </div>
                    </label>
                    <div x-show="isUploading" class="mt-6 flex items-center justify-center gap-3 text-[#C5A059] font-black text-center">
                        <svg class="animate-spin h-6 w-6" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        æ­£åœ¨å®‰å…¨å‚³è¼¸è‡³ä¼ºæœå™¨...
                    </div>
                </div>

                <div x-show="uploadStep === 'done'" class="text-center py-12 ml-0 md:ml-12" x-cloak text-center>
                    <div class="w-20 h-20 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6 text-4xl shadow-inner text-center text-center text-center text-center">âœ“</div>
                    <h3 class="text-2xl font-black text-slate-900">æª”æ¡ˆå·²æˆåŠŸèˆ‡å ±åƒ¹å–®é€£çµ</h3>
                    <p class="text-slate-500 font-bold mt-2">æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„è¨­è¨ˆç¨¿ï¼Œé¡§å•æ­£åœ¨æª¢æŸ¥æª”æ¡ˆè§£æåº¦èˆ‡åˆ€æ¨¡è¦æ ¼ã€‚</p>
                    <button @click="uploadStep = 'upload'" class="mt-8 bg-slate-900 text-white px-8 py-3 rounded-full font-black text-sm hover:bg-black transition-all text-center">å†ä¸Šå‚³ä¸€å€‹æª”æ¡ˆ</button>
                </div>
            </div>
        </section>
    </main>

    <div x-show="showSuccess" class="fixed inset-0 bg-slate-900/95 backdrop-blur-3xl flex items-center justify-center z-50 p-6" x-cloak x-transition>
        <div class="bg-white rounded-[4rem] p-12 md:p-20 max-w-2xl w-full text-center relative shadow-[0_0_100px_rgba(197,160,89,0.4)] text-center">
            <div class="w-24 h-24 md:w-32 md:h-32 bg-[#C5A059]/10 text-[#C5A059] rounded-full flex items-center justify-center mx-auto mb-10 text-6xl md:text-7xl shadow-inner text-center">âœ“</div>
            <h3 class="text-3xl md:text-5xl font-black text-slate-900 mb-2 tracking-tighter text-center">æ­£å¼å ±åƒ¹å–®å·²å®Œæˆå»ºç«‹</h3>
            <p class="text-[#C5A059] font-black text-lg md:text-2xl mb-8 text-center">å ±åƒ¹ç·¨è™Ÿï¼š<span x-text="quoteNumber"></span></p>
            <p class="text-slate-600 mb-12 text-lg md:text-xl font-bold leading-relaxed text-center">
                PDF å·²å¯„é€è‡³ <span class="text-slate-900 underline" x-text="formData.email"></span>ã€‚<br>
                <span class="text-slate-900">æ‚¨å¯ä»¥ç›´æ¥åœ¨ä¸‹æ–¹è£œå‚³è¨­è¨ˆæª”æ¡ˆã€‚</span>
            </p>
            <button @click="showSuccess = false; $nextTick(() => document.getElementById('upload-section').scrollIntoView({behavior:'smooth'}))" class="w-full bg-slate-900 text-white py-6 rounded-[2rem] font-black text-xl md:text-2xl shadow-xl text-center">å‰å¾€æª”æ¡ˆä¸Šå‚³å€</button>
        </div>
    </div>

    <script>
        function quoteSystem() {
            return {
                // åŸæœ‰è®Šæ•¸
                selectedStageId: 'growth',
                selectedPlanId: 'C',
                selectedPlan: {},
                selectedMaterial: { name: 'å°¼é¾ï¼ˆæœ‰ç·šï¼‰', surcharge: 1.2, type: 'æœ‰ç·š' },
                quantity: 4500,
                showForm: false,
                loading: false,
                showSuccess: false,
                quoteNumber: '', // é€™é‚Šæœƒå­˜ QT-XXXX
                formData: { company: '', name: '', email: '', contact: '' },
                
                // æ–°å¢ä¸Šå‚³ç‹€æ…‹
                uploadStep: 'email',
                uploadEmail: '',
                otpInput: '',
                isVerifying: false,
                isUploading: false,
                uploadToken: '',
                gasUrl: 'https://script.google.com/macros/s/AKfycbzAQ4XA5e1I2rCBjX9x7XEjA6m2qB8egcRUtFm_j_Vb3N2iQ5lm2FhhK_O--Xur_c-5/exec', 

                stages: [
                    { id: 'startup', name: 'æ–°å‰µæ¸¬è©¦å¸‚å ´', icon: 'ğŸš€', desc: 'ä½èµ·è¨‚é‡å¸‚å ´åˆ‡å…¥é»ï¼Œæ¥µé€Ÿæ‰“æ¨£é©—è­‰å“ç‰Œæ½›åŠ›ã€‚' },
                    { id: 'growth', name: 'æˆé•·æ“´å¼µ', icon: 'ğŸ“ˆ', desc: 'æœ€ä½³è³ªæ„Ÿèˆ‡è¦æ¨¡æ•ˆç›Šå¹³è¡¡é»ï¼Œä¸­å¤§å‹é€šè·¯é¦–é¸ã€‚', recommended: true },
                    { id: 'enterprise', name: 'ä¼æ¥­æ¡è³¼', icon: 'ğŸ¢', desc: 'æ¥µè‡´é‡ç”¢ï¼Œå…¨çƒé€šè·¯æ¨™é…è¦æ ¼èˆ‡ç©©å®šæ”¯æŒã€‚' }
                ],
                allPlans: [
                    { id: 'A', name: 'å–®åŒ…åŸºæœ¬', base: 5.63, moq: 550, canBox: false, advBox: false },
                    { id: 'B', name: 'å–®åŒ…é€²éš', base: 5.63, moq: 550, canBox: false, advBox: false },
                    { id: 'C', name: 'ç›’è£åŸºæœ¬', base: 3.00, moq: 4500, canBox: true, advBox: false },
                    { id: 'D', name: 'ç›’è£é€²éš', base: 2.80, moq: 15000, canBox: true, advBox: true },
                    { id: 'E', name: 'å®¢è£½è¦æ ¼', base: 0, moq: 'å°ˆæ¡ˆè©•ä¼°', canBox: true, advBox: true }
                ],
                materials: [
                    { name: 'å°¼é¾ï¼ˆæœ‰ç·šï¼‰', surcharge: 1.2, type: 'æœ‰ç·š' },
                    { name: 'ç‰ç±³çº–ç¶­ï¼ˆæœ‰ç·šï¼‰', surcharge: 1.2, type: 'æœ‰ç·š' },
                    { name: 'ä¸ç¹”å¸ƒï¼ˆæœ‰ç·šï¼‰', surcharge: 1.2, type: 'æœ‰ç·š' },
                    { name: 'å°¼é¾ï¼ˆç„¡ç·šï¼‰', surcharge: 1.0, type: 'ç„¡ç·š' },
                    { name: 'ä¸ç¹”å¸ƒï¼ˆç„¡ç·šï¼‰', surcharge: 0.7, type: 'ç„¡ç·š' }
                ],
                qtyOptions: [500, 550, 1000, 1500, 2000, 4500, 10000, 15000, 20000, 50000],

                init() { this.selectPlan(this.allPlans[2]); },
                selectStage(stage) {
                    this.selectedStageId = stage.id;
                    if (stage.id === 'startup') this.selectPlan(this.allPlans[0]);
                    if (stage.id === 'growth') this.selectPlan(this.allPlans[2]);
                    if (stage.id === 'enterprise') this.selectPlan(this.allPlans[3]);
                },
                selectPlan(plan) {
                    this.selectedPlanId = plan.id;
                    this.selectedPlan = plan;
                    if (typeof plan.moq === 'number' && this.quantity < plan.moq) this.quantity = plan.moq;
                },
                getPlanBg(planId) {
                    const map = { 'A': 'bg-[#7F1D1D] text-white', 'B': 'bg-[#7C2D12] text-white', 'C': 'bg-[#FACC15] text-[#1A302B]', 'D': 'bg-[#064E3B] text-white', 'E': 'bg-[#0C4A6E] text-white' };
                    return map[planId] || 'bg-slate-100';
                },
                getMatBg(type) { return type === 'æœ‰ç·š' ? 'bg-[#ECFDF5] border-[#059669]' : 'bg-[#FFF7ED] border-[#EA580C]'; },
                get canBox() { return this.selectedPlan.canBox; },
                get boxName() { return this.selectedPlan.advBox ? 'é€²éšæ–¹æ¡ˆï¼šä¸Šæ€ç›’ M' : 'æ¨™æº–æ–¹æ¡ˆï¼šä¸Šæ€ç›’'; },
                get minMoq() { return typeof this.selectedPlan.moq === 'number' ? this.selectedPlan.moq : 0; },
                get lowMoqSurcharge() {
                    const q = parseInt(this.quantity);
                    if (q >= 2000) return 0;
                    if (q >= 1000) return 0.3;
                    return 0.8;
                },
                get finalUnitPrice() {
                    if (this.selectedPlanId === 'E') return "æ´½è©¢é¡§å•";
                    let total = this.selectedPlan.base + this.selectedMaterial.surcharge + this.lowMoqSurcharge;
                    if (this.quantity >= 20000) total *= 0.8;
                    else if (this.quantity >= 10000) total *= 0.9;
                    return total.toFixed(2);
                },
                get totalPrice() {
                    if (this.selectedPlanId === 'E') return 0;
                    let product = Math.round(parseFloat(this.finalUnitPrice) * this.quantity);
                    let fees = this.canBox ? (525 + 300) : 0;
                    return product + fees;
                },

                // æäº¤å ±åƒ¹
                async handleSubmit() {
                    this.loading = true;
                    const now = new Date();
                    this.quoteNumber = `QT-${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(Math.floor(Math.random()*9999)).padStart(4,'0')}`;
                    this.uploadEmail = this.formData.email; // åŒæ­¥ Email æ–¹ä¾¿ç¨å¾Œä¸Šå‚³ä½¿ç”¨

                    const payload = {
                        action: 'saveQuote',
                        quoteNumber: this.quoteNumber,
                        customer: this.formData,
                        quoteDetails: {
                            plan: `æ–¹æ¡ˆ ${this.selectedPlanId}ï½œ${this.selectedPlan.name}`,
                            material: this.selectedMaterial.name,
                            quantity: this.quantity,
                            unitPrice: this.finalUnitPrice,
                            totalPrice: this.totalPrice
                        }
                    };

                    try {
                        await fetch(this.gasUrl, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });
                        await new Promise(r => setTimeout(r, 2000));
                        this.showSuccess = true;
                        this.showForm = false;
                    } catch (err) { alert('ç™¼é€å¤±æ•—ï¼Œè«‹ç¢ºèªç¶²è·¯é€£ç·šã€‚'); } finally { this.loading = false; }
                },

                // æª”æ¡ˆä¸Šå‚³ç›¸é—œé‚è¼¯
                async sendOTP() {
                    if (!this.uploadEmail || !this.quoteNumber) return alert('è«‹å¡«å¯«å ±åƒ¹ç·¨è™Ÿèˆ‡ Email');
                    this.isVerifying = true;
                    try {
                        const res = await fetch(this.gasUrl, { method: 'POST', body: JSON.stringify({ action: 'sendOTP', email: this.uploadEmail, quoteNumber: this.quoteNumber }) });
                        const data = await res.json();
                        if (data.success) { this.uploadStep = 'otp'; } else { alert(data.msg); }
                    } catch (e) { alert('é©—è­‰ç¢¼å¯„é€å¤±æ•—'); } finally { this.isVerifying = false; }
                },

                async verifyOTP() {
                    this.isVerifying = true;
                    try {
                        const res = await fetch(this.gasUrl, { method: 'POST', body: JSON.stringify({ action: 'verifyOTP', email: this.uploadEmail, otp: this.otpInput }) });
                        const data = await res.json();
                        if (data.success) { 
                            this.uploadToken = data.token;
                            this.uploadStep = 'upload'; 
                        } else { alert('é©—è­‰ç¢¼ä¸æ­£ç¢º'); }
                    } catch (e) { alert('é€£ç·šå¤±æ•—'); } finally { this.isVerifying = false; }
                },

                async handleFileUpload(e) {
                    const file = e.target.files[0];
                    if (!file) return;
                    if (file.size > 10 * 1024 * 1024) return alert('æª”æ¡ˆä¸å¯è¶…é 10MB');

                    this.isUploading = true;
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = async () => {
                        try {
                            const res = await fetch(this.gasUrl, {
                                method: 'POST',
                                body: JSON.stringify({
                                    action: 'uploadFile',
                                    quoteNumber: this.quoteNumber,
                                    token: this.uploadToken,
                                    fileName: file.name,
                                    fileData: reader.result
                                })
                            });
                            const data = await res.json();
                            if (data.success) { this.uploadStep = 'done'; } else { alert('ä¸Šå‚³å¤±æ•—ï¼š' + data.msg); }
                        } catch (e) { alert('ä¸Šå‚³é€£ç·šå¤±æ•—'); } finally { this.isUploading = false; }
                    };
                }
            }
        }
    </script>
</body>
</html>